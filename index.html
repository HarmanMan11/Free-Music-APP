<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Free Music App</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #121212;
    color: #e0e0e0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  header {
    background-color: #1f1f1f;
    padding: 1.5rem;
    text-align: center;
    box-shadow: 0 3px 6px #000000aa;
  }
  header h1 {
    margin: 0;
    font-weight: 700;
    font-size: 2rem;
    color: #00ff88;
  }
  .controls {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
    justify-content: center;
    background: #222;
    padding: 1rem;
  }
  .controls input[type="search"] {
    flex-grow: 1;
    max-width: 300px;
    padding: 0.5rem 1rem;
    border-radius: 30px;
    border: none;
    font-size: 1rem;
    outline: none;
  }
  .controls button {
    background-color: #00ff88;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 25px;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.3s ease;
    color: #121212;
  }
  .controls button:hover {
    background-color: #00cc66;
  }
  #trackList {
    flex-grow: 1;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    max-width: 720px;
    margin: 0 auto 2rem auto;
  }
  .track {
    background-color: #2e2e2e;
    padding: 1rem;
    border-radius: 10px;
    box-shadow: 0 2px 8px #000000aa;
    position: relative;
  }
  .track h3 {
    margin: 0 0 0.5rem 0;
    font-weight: 700;
    color: #00ff88;
  }
  audio {
    width: 100%;
    outline: none;
    border-radius: 8px;
  }
  .like {
    position: absolute;
    top: 1rem;
    right: 1rem;
    cursor: pointer;
    font-size: 1.8rem;
    user-select: none;
    transition: color 0.3s ease;
  }
  .like.liked {
    color: #ff4081;
  }
  footer {
    background-color: #1f1f1f;
    text-align: center;
    padding: 1rem;
    font-size: 0.9rem;
    color: #666;
    user-select: none;
  }
  /* Light theme override */
  body.light {
    background-color: #fefefe;
    color: #222;
  }
  body.light header {
    background-color: #d3f9d8;
    box-shadow: 0 3px 6px #c1c1c1;
  }
  body.light .controls {
    background-color: #e6ffe6;
  }
  body.light .track {
    background-color: #fff;
    box-shadow: 0 2px 8px #aaa;
    color: #222;
  }
  body.light .track h3 {
    color: #009933;
  }
  body.light .like.liked {
    color: #d5005f;
  }
  body.light footer {
    background-color: #d3f9d8;
    color: #444;
  }
</style>
</head>
<body>

<header>
  <h1>üéµ Free Music App</h1>
</header>

<div class="controls">
  <input type="search" id="search" placeholder="–ü–æ–∏—Å–∫ —Ç—Ä–µ–∫–∞..." />
  <button data-genre="all">–í—Å–µ</button>
  <button data-genre="classical">–ö–ª–∞—Å—Å–∏–∫–∞</button>
  <button data-genre="lounge">–õ–∞—É–Ω–∂</button>
  <button data-genre="electronic">–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</button>
  <button data-genre="vintage">–í–∏–Ω—Ç–∞–∂</button>
  <button data-genre="ethno">–≠—Ç–Ω–æ</button>
  <button data-genre="live">–õ–∞–π–≤</button>
  <button id="showFavoritesBtn">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
  <button id="toggleThemeBtn">üåì –¢–µ–º–∞</button>
</div>

<div id="trackList"></div>

<footer>
  Made with ‚ù§Ô∏è using archive.org open music
</footer>

<script>
(() => {
  const tracks = [
    { title: "Beethoven - Symphony No.5", src: "https://archive.org/download/BeethovenSymphony5/BeethovenSymphony5.mp3", genre: "classical" },
    { title: "Chopin - Prelude No.15", src: "https://archive.org/download/Chopin_Prelude_No_15/Chopin_Prelude_No_15.mp3", genre: "classical" },
    { title: "Electronic Breeze", src: "https://archive.org/download/electronic_beats/electronic_breeze.mp3", genre: "electronic" },
    { title: "Lounge Cafe", src: "https://archive.org/download/lounge_collection/lounge_cafe.mp3", genre: "lounge" },
    { title: "Vintage Jazz", src: "https://archive.org/download/vintage_jazz/vintage_jazz_01.mp3", genre: "vintage" },
    { title: "Ethno Vibes", src: "https://archive.org/download/ethno_collection/ethno_vibes.mp3", genre: "ethno" },
    { title: "Live Session A", src: "https://archive.org/download/live_music_a/live_session_a.mp3", genre: "live" },
  ];

  let appState = {
    currentGenre: 'all',
    favorites: JSON.parse(localStorage.getItem('favorites') || '[]'),
    showingFavorites: false,
  };

  const trackListEl = document.getElementById('trackList');
  const searchInput = document.getElementById('search');
  const showFavoritesBtn = document.getElementById('showFavoritesBtn');
  const toggleThemeBtn = document.getElementById('toggleThemeBtn');
  const genreButtons = document.querySelectorAll('.controls button[data-genre]');

  function saveFavorites() {
    localStorage.setItem('favorites', JSON.stringify(appState.favorites));
  }

  function isFavorite(src) {
    return appState.favorites.includes(src);
  }

  function toggleLike(src, el) {
    if (isFavorite(src)) {
      appState.favorites = appState.favorites.filter(f => f !== src);
      el.classList.remove('liked');
    } else {
      appState.favorites.push(src);
      el.classList.add('liked');
    }
    saveFavorites();
  }

  function createTrackElement(track) {
    const div = document.createElement('div');
    div.className = 'track';
    div.innerHTML = `
      <h3>${track.title}</h3>
      <audio controls src="${track.src}"></audio>
      <div class="like ${isFavorite(track.src) ? 'liked' : ''}" title="–î–æ–±–∞–≤–∏—Ç—å/—É–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ">‚ù§Ô∏è</div>
    `;
    const likeEl = div.querySelector('.like');
    likeEl.addEventListener('click', () => toggleLike(track.src, likeEl));
    return div;
  }

  function renderTracks() {
    trackListEl.innerHTML = '';

    let filteredTracks;

    if (appState.showingFavorites) {
      filteredTracks = tracks.filter(t => isFavorite(t.src));
    } else {
      filteredTracks = tracks.filter(t => appState.currentGenre === 'all' || t.genre === appState.currentGenre);
      const searchVal = searchInput.value.trim().toLowerCase();
      if (searchVal) {
        filteredTracks = filteredTracks.filter(t => t.title.toLowerCase().includes(searchVal));
      }
    }

    if (filteredTracks.length === 0) {
      trackListEl.textContent = '–¢—Ä–µ–∫–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.';
      return;
    }

    filteredTracks.forEach(track => {
      trackListEl.appendChild(createTrackElement(track));
    });
  }

  function setGenre(genre) {
    appState.currentGenre = genre;
    appState.showingFavorites = false;
    showFavoritesBtn.textContent = '‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ';
    renderTracks();
  }

  function toggleFavoritesView() {
    appState.showingFavorites = !appState.showingFavorites;
    showFavoritesBtn.textContent = appState.showingFavorites ? '‚¨ÖÔ∏è –í—Å–µ —Ç—Ä–µ–∫–∏' : '‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ';
    renderTracks();
  }

  function toggleTheme() {
    document.body.classList.toggle('light');
  }

  // –ò–≤–µ–Ω—Ç—ã
  searchInput.addEventListener('input', () => {
    appState.showingFavorites = false;
    showFavoritesBtn.textContent = '‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ';
    renderTracks();
  });

  genreButtons.forEach(btn => {
    btn.addEventListener('click', () => setGenre(btn.dataset.genre));
  });

  showFavoritesBtn.addEventListener('click', toggleFavoritesView);
  toggleThemeBtn.addEventListener('click', toggleTheme);

  // –†–µ–Ω–¥–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  renderTracks();
})();
</script>

</body>
</html>
