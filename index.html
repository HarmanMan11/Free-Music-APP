<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Free Music App</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet" />
  <style>
    /* Reset & Base */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: #121212;
      color: white;
      padding-bottom: 4rem;
      transition: background-color 0.4s ease, color 0.4s ease;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      background-color: #1f1f1f;
      padding: 1rem 1.5rem;
      width: 100%;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.6);
      user-select: none;
    }
    h1 {
      margin: 0;
      color: #00ff88;
      font-weight: 700;
      font-size: 2rem;
      letter-spacing: 1px;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      padding: 1rem 1.5rem;
      background-color: #1a1a1a;
      width: 100%;
      max-width: 960px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
      border-radius: 12px;
      margin: 1rem 0;
      user-select: none;
    }
    .controls input {
      flex: 1 1 200px;
      padding: 0.6rem 1rem;
      border-radius: 8px;
      border: none;
      outline: none;
      font-size: 1rem;
      transition: box-shadow 0.3s ease;
      background-color: #282828;
      color: white;
      box-shadow: inset 0 0 5px #00ff88;
    }
    .controls input::placeholder {
      color: #aaa;
    }
    .controls input:focus {
      box-shadow: 0 0 10px #00ff88;
      background-color: #1e1e1e;
    }
    .controls button {
      background-color: #00ff88;
      border: none;
      border-radius: 8px;
      padding: 0.5rem 1.2rem;
      cursor: pointer;
      font-weight: 600;
      color: #121212;
      box-shadow: 0 4px 6px rgba(0,255,136,0.6);
      transition: background-color 0.3s ease, transform 0.15s ease;
      user-select: none;
      flex: 0 0 auto;
    }
    .controls button:hover {
      background-color: #00cc6a;
      transform: scale(1.05);
    }
    .controls button:active {
      transform: scale(0.95);
    }
    .track-list {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.2rem;
      padding: 0 1.5rem 3rem;
      width: 100%;
      max-width: 960px;
      flex-grow: 1;
    }
    .track {
      background: #2e2e2e;
      padding: 1rem 1.2rem;
      border-radius: 14px;
      max-width: 600px;
      width: 100%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.6);
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    .track:hover {
      background-color: #393939;
    }
    .track h3 {
      margin: 0;
      font-weight: 700;
      font-size: 1.2rem;
      color: #00ff88;
      user-select: text;
    }
    audio {
      width: 100%;
      outline: none;
      border-radius: 8px;
      box-shadow: inset 0 0 5px #00ff88;
      background-color: #121212;
    }
    .like {
      position: absolute;
      top: 1rem;
      right: 1rem;
      cursor: pointer;
      font-size: 1.8rem;
      user-select: none;
      transition: transform 0.3s ease, color 0.3s ease;
      color: #bbb;
      filter: drop-shadow(0 0 2px #000);
    }
    .like:hover {
      transform: scale(1.3);
      color: #ff4081;
      filter: drop-shadow(0 0 6px #ff4081);
    }
    .like.liked {
      color: #ff4081;
      animation: heartbeat 1s infinite;
      filter: drop-shadow(0 0 8px #ff4081);
    }
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }
    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #1f1f1f;
      padding: 1rem;
      text-align: center;
      color: #888;
      user-select: none;
      font-size: 0.9rem;
      box-shadow: 0 -2px 6px rgba(0,0,0,0.7);
    }
    /* Light theme */
    body.light-theme {
      background-color: white;
      color: #121212;
    }
    body.light-theme header {
      background-color: #e0e0e0;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    body.light-theme .controls {
      background-color: #f5f5f5;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    body.light-theme .controls input {
      background-color: #fff;
      color: #121212;
      box-shadow: inset 0 0 5px #00cc6a;
    }
    body.light-theme .controls input::placeholder {
      color: #666;
    }
    body.light-theme .track {
      background-color: #f0f0f0;
      color: #121212;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    body.light-theme .track:hover {
      background-color: #e6e6e6;
    }
    body.light-theme audio {
      background-color: #fff;
      box-shadow: inset 0 0 5px #00cc6a;
    }
    body.light-theme .like {
      color: #888;
      filter: none;
    }
    body.light-theme .like:hover {
      color: #e91e63;
      filter: drop-shadow(0 0 6px #e91e63);
    }
    body.light-theme .like.liked {
      color: #e91e63;
      filter: drop-shadow(0 0 8px #e91e63);
    }
    body.light-theme .footer {
      background: #e0e0e0;
      color: #444;
      box-shadow: 0 -2px 6px rgba(0,0,0,0.05);
    }
    /* Responsive */
    @media (max-width: 640px) {
      .controls {
        flex-direction: column;
        gap: 0.7rem;
      }
      .controls input {
        flex: 1 1 100%;
      }
      .controls button {
        flex: 1 1 100%;
      }
      .track {
        max-width: 100%;
      }
      .track-list {
        padding: 0 1rem 3rem;
      }
    }
  </style>
</head>
<body>

  <header>
    <h1>üéµ Free Music App</h1>
  </header>

  <div class="controls">
    <input id="search" type="text" placeholder="–ü–æ–∏—Å–∫ —Ç—Ä–µ–∫–∞..." autocomplete="off" />
    <button onclick="filterByGenre('all')">–í—Å–µ</button>
    <button onclick="filterByGenre('classical')">–ö–ª–∞—Å—Å–∏–∫–∞</button>
    <button onclick="filterByGenre('lounge')">–õ–∞—É–Ω–∂</button>
    <button onclick="filterByGenre('electronic')">–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</button>
    <button onclick="filterByGenre('vintage')">–í–∏–Ω—Ç–∞–∂</button>
    <button onclick="filterByGenre('ethno')">–≠—Ç–Ω–æ</button>
    <button onclick="filterByGenre('live')">–õ–∞–π–≤</button>
    <button onclick="showFavorites()">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
    <button onclick="toggleTheme()">üåì –¢–µ–º–∞</button>
  </div>

  <div class="track-list" id="trackList" role="list"></div>

  <div class="footer">
    Made with ‚ù§Ô∏è using archive.org open music
  </div>

  <script>
    // –¢—Ä–µ–∫–∏
    const tracks = [
      { title: "Beethoven - Symphony No.5", src: "https://archive.org/download/BeethovenSymphony5/BeethovenSymphony5.mp3", genre: "classical" },
      { title: "Chopin - Prelude No.15", src: "https://archive.org/download/Chopin_Prelude_No_15/Chopin_Prelude_No_15.mp3", genre: "classical" },
      { title: "Electronic Breeze", src: "https://archive.org/download/electronic_beats/electronic_breeze.mp3", genre: "electronic" },
      { title: "Lounge Cafe", src: "https://archive.org/download/lounge_collection/lounge_cafe.mp3", genre: "lounge" },
      { title: "Vintage Jazz", src: "https://archive.org/download/vintage_jazz/vintage_jazz_01.mp3", genre: "vintage" },
      { title: "Ethno Vibes", src: "https://archive.org/download/ethno_collection/ethno_vibes.mp3", genre: "ethno" },
      { title: "Live Session A", src: "https://archive.org/download/live_music_a/live_session_a.mp3", genre: "live" },
    ];

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    window.appState = window.appState || {
      currentGenre: 'all',
      favorites: JSON.parse(localStorage.getItem('favorites') || '[]'),
      isShowingFavorites: false,
    };

    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ —Ç—Ä–µ–∫–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
    function renderTracks(filter = '') {
      const list = document.getElementById('trackList');
      list.innerHTML = '';

      const lowerFilter = filter.toLowerCase();

      // –í—ã–±–∏—Ä–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: –ª–∏–±–æ –≤—Å–µ —Ç—Ä–µ–∫–∏ –ø–æ –∂–∞–Ω—Ä—É + –ø–æ–∏—Å–∫—É, –ª–∏–±–æ —Ç–æ–ª—å–∫–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ
      let filteredTracks = [];

      if (appState.isShowingFavorites) {
        filteredTracks = tracks.filter(t => appState.favorites.includes(t.src));
      } else {
        filteredTracks = tracks.filter(t =>
          (appState.currentGenre === 'all' || t.genre === appState.currentGenre) &&
          t.title.toLowerCase().includes(lowerFilter)
        );
      }

      if (filteredTracks.length === 0) {
        list.innerHTML = '<p style="color:#888; font-style:italic; user-select:none;">–¢—Ä–µ–∫–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>';
        return;
      }

      filteredTracks.forEach(track => {
        const div = document.createElement('div');
        div.className = 'track';
        div.setAttribute('role', 'listitem');
        const liked = appState.favorites.includes(track.src);

        div.innerHTML = `
          <h3>${track.title}</h3>
          <audio controls src="${track.src}"></audio>
          <div class="like ${liked ? 'liked' : ''}" title="–ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å" role="button" aria-pressed="${liked}" tabindex="0">‚ù§Ô∏è</div>
        `;

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ª–∞–π–∫–∞ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (Enter/Space)
        const likeEl = div.querySelector('.like');
        likeEl.addEventListener('click', () => toggleLike(track.src, likeEl));
        likeEl.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            toggleLike(track.src, likeEl);
          }
        });

        list.appendChild(div);
      });
    }

    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∂–∞–Ω—Ä—É
    function filterByGenre(genre) {
      appState.currentGenre = genre;
      appState.isShowingFavorites = false;
      document.getElementById('search').value = '';
      renderTracks('');
    }

    // –õ–∞–π–∫/–¥–∏–∑–ª–∞–π–∫ —Ç—Ä–µ–∫–∞
    function toggleLike(src, el) {
      if (appState.favorites.includes(src)) {
        appState.favorites = appState.favorites.filter(f => f !== src);
        el.classList.remove('liked');
        el.setAttribute('aria-pressed', 'false');
      } else {
        appState.favorites.push(src);
        el.classList.add('liked');
        el.setAttribute('aria-pressed', 'true');
      }
      localStorage.setItem('favorites', JSON.stringify(appState.favorites));
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
    function showFavorites() {
      appState.isShowingFavorites = true;
      document.getElementById('search').value = '';
      renderTracks('');
    }

    // Debounce –¥–ª—è –ø–æ–∏—Å–∫–∞
    function debounce(func, delay) {
      let timeoutId;
      return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => func.apply(this, args), delay);
      };
    }

    const searchInput = document.getElementById('search');
    searchInput.addEventListener('input', debounce((e) => {
      appState.isShowingFavorites = false;
      renderTracks(e.target.value);
    }, 300));

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã —Å –ø–ª–∞–≤–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π
    function toggleTheme() {
      document.body.classList.toggle('light-theme');
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    filterByGenre('all'); // —á—Ç–æ–±—ã –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å —Å—Ä–∞–∑—É –≤—Å–µ

  </script>
</body>
</html>
